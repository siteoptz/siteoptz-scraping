{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useUser}from'../contexts/UserContext';import CyfeService from'../services/CyfeService';import DashboardAuth from'./DashboardAuth';import'./CyfeDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CyfeDashboard=_ref=>{let{dashboardId,dashboardName,requiredPlan='free',className='',height='600px',showControls=true}=_ref;const{user,currentPlan}=useUser();const[dashboardUrl,setDashboardUrl]=useState('');const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const iframeRef=useRef(null);useEffect(()=>{generateDashboardUrl();},[dashboardId,user===null||user===void 0?void 0:user.id,currentPlan]);const generateDashboardUrl=async()=>{try{setIsLoading(true);setError(null);// Generate authenticated dashboard URL\nconst url=CyfeService.generateDashboardUrl(dashboardId,user===null||user===void 0?void 0:user.id,currentPlan);setDashboardUrl(url);}catch(err){setError(err.message);console.error('Error generating dashboard URL:',err);}finally{setIsLoading(false);}};const handleIframeLoad=()=>{setIsLoading(false);};const handleIframeError=()=>{setError('Failed to load dashboard');setIsLoading(false);};const refreshDashboard=()=>{if(iframeRef.current){iframeRef.current.src=iframeRef.current.src;}};const openInNewTab=()=>{window.open(dashboardUrl,'_blank');};if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"cyfe-dashboard-error \".concat(className),children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Dashboard Error\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:generateDashboardUrl,className:\"retry-button\",children:\"Retry\"})]})});}return/*#__PURE__*/_jsx(DashboardAuth,{dashboardId:dashboardId,requiredPlan:requiredPlan,children:/*#__PURE__*/_jsxs(\"div\",{className:\"cyfe-dashboard \".concat(className),children:[showControls&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:dashboardName}),/*#__PURE__*/_jsx(\"span\",{className:\"plan-badge\",children:requiredPlan})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-controls\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:refreshDashboard,className:\"control-button\",title:\"Refresh Dashboard\",children:\"\\uD83D\\uDD04\"}),/*#__PURE__*/_jsx(\"button\",{onClick:openInNewTab,className:\"control-button\",title:\"Open in New Tab\",children:\"\\uD83D\\uDD17\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-container\",style:{height},children:[isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading dashboard...\"})]}),/*#__PURE__*/_jsx(\"iframe\",{ref:iframeRef,src:dashboardUrl,title:dashboardName,className:\"dashboard-iframe\",onLoad:handleIframeLoad,onError:handleIframeError,style:{display:isLoading?'none':'block'},sandbox:\"allow-scripts allow-same-origin allow-forms\"})]})]})});};export default CyfeDashboard;","map":{"version":3,"names":["React","useState","useEffect","useRef","useUser","CyfeService","DashboardAuth","jsx","_jsx","jsxs","_jsxs","CyfeDashboard","_ref","dashboardId","dashboardName","requiredPlan","className","height","showControls","user","currentPlan","dashboardUrl","setDashboardUrl","isLoading","setIsLoading","error","setError","iframeRef","generateDashboardUrl","id","url","err","message","console","handleIframeLoad","handleIframeError","refreshDashboard","current","src","openInNewTab","window","open","concat","children","onClick","title","style","ref","onLoad","onError","display","sandbox"],"sources":["/Users/siteoptz/siteoptz-scraping/src/components/CyfeDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useUser } from '../contexts/UserContext';\nimport CyfeService from '../services/CyfeService';\nimport DashboardAuth from './DashboardAuth';\nimport './CyfeDashboard.css';\n\nconst CyfeDashboard = ({ \n  dashboardId, \n  dashboardName, \n  requiredPlan = 'free',\n  className = '',\n  height = '600px',\n  showControls = true \n}) => {\n  const { user, currentPlan } = useUser();\n  const [dashboardUrl, setDashboardUrl] = useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const iframeRef = useRef(null);\n\n  useEffect(() => {\n    generateDashboardUrl();\n  }, [dashboardId, user?.id, currentPlan]);\n\n  const generateDashboardUrl = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Generate authenticated dashboard URL\n      const url = CyfeService.generateDashboardUrl(dashboardId, user?.id, currentPlan);\n      setDashboardUrl(url);\n    } catch (err) {\n      setError(err.message);\n      console.error('Error generating dashboard URL:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleIframeLoad = () => {\n    setIsLoading(false);\n  };\n\n  const handleIframeError = () => {\n    setError('Failed to load dashboard');\n    setIsLoading(false);\n  };\n\n  const refreshDashboard = () => {\n    if (iframeRef.current) {\n      iframeRef.current.src = iframeRef.current.src;\n    }\n  };\n\n  const openInNewTab = () => {\n    window.open(dashboardUrl, '_blank');\n  };\n\n  if (error) {\n    return (\n      <div className={`cyfe-dashboard-error ${className}`}>\n        <div className=\"error-content\">\n          <div className=\"error-icon\">‚ö†Ô∏è</div>\n          <h3>Dashboard Error</h3>\n          <p>{error}</p>\n          <button onClick={generateDashboardUrl} className=\"retry-button\">\n            Retry\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <DashboardAuth dashboardId={dashboardId} requiredPlan={requiredPlan}>\n      <div className={`cyfe-dashboard ${className}`}>\n        {showControls && (\n          <div className=\"dashboard-header\">\n            <div className=\"dashboard-info\">\n              <h3>{dashboardName}</h3>\n              <span className=\"plan-badge\">{requiredPlan}</span>\n            </div>\n            <div className=\"dashboard-controls\">\n              <button \n                onClick={refreshDashboard}\n                className=\"control-button\"\n                title=\"Refresh Dashboard\"\n              >\n                üîÑ\n              </button>\n              <button \n                onClick={openInNewTab}\n                className=\"control-button\"\n                title=\"Open in New Tab\"\n              >\n                üîó\n              </button>\n            </div>\n          </div>\n        )}\n        \n        <div className=\"dashboard-container\" style={{ height }}>\n          {isLoading && (\n            <div className=\"dashboard-loading\">\n              <div className=\"loading-spinner\"></div>\n              <p>Loading dashboard...</p>\n            </div>\n          )}\n          \n          <iframe\n            ref={iframeRef}\n            src={dashboardUrl}\n            title={dashboardName}\n            className=\"dashboard-iframe\"\n            onLoad={handleIframeLoad}\n            onError={handleIframeError}\n            style={{ display: isLoading ? 'none' : 'block' }}\n            sandbox=\"allow-scripts allow-same-origin allow-forms\"\n          />\n        </div>\n      </div>\n    </DashboardAuth>\n  );\n};\n\nexport default CyfeDashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}