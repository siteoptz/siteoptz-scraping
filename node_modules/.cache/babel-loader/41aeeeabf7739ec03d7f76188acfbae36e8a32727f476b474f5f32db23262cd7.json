{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useUser}from'../contexts/UserContext';import CyfeService from'../services/CyfeService';import'./DashboardAuth.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const DashboardAuth=_ref=>{let{children,dashboardId,requiredPlan}=_ref;const{user,currentPlan}=useUser();const[hasAccess,setHasAccess]=useState(false);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{checkDashboardAccess();},[dashboardId,currentPlan]);const checkDashboardAccess=async()=>{try{setIsLoading(true);setError(null);// Check if user has access to the dashboard\nconst access=CyfeService.hasDashboardAccess(user===null||user===void 0?void 0:user.id,currentPlan,dashboardId);// Check if user's plan meets requirements\nconst planHierarchy=['free','starter','pro','enterprise'];const currentPlanIndex=planHierarchy.indexOf(currentPlan);const requiredPlanIndex=planHierarchy.indexOf(requiredPlan);const planAccess=currentPlanIndex>=requiredPlanIndex;setHasAccess(access&&planAccess);if(!access){setError('Dashboard not available for your current plan');}else if(!planAccess){setError(\"This dashboard requires \".concat(requiredPlan,\" plan or higher\"));}}catch(err){setError('Error checking dashboard access');console.error('Dashboard access check failed:',err);}finally{setIsLoading(false);}};if(isLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-auth-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Checking dashboard access...\"})]});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-auth-error\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Access Restricted\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"upgrade-button\",onClick:()=>window.location.href=\"/dashboard/\".concat(currentPlan,\"#upgrade\"),children:\"Upgrade Plan\"})]});}if(!hasAccess){return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-auth-denied\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"denied-icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Dashboard Not Available\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This dashboard is not included in your current plan.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"upgrade-button\",onClick:()=>window.location.href=\"/dashboard/\".concat(currentPlan,\"#upgrade\"),children:\"View Upgrade Options\"})]});}return/*#__PURE__*/_jsx(_Fragment,{children:children});};export default DashboardAuth;","map":{"version":3,"names":["React","useState","useEffect","useUser","CyfeService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DashboardAuth","_ref","children","dashboardId","requiredPlan","user","currentPlan","hasAccess","setHasAccess","isLoading","setIsLoading","error","setError","checkDashboardAccess","access","hasDashboardAccess","id","planHierarchy","currentPlanIndex","indexOf","requiredPlanIndex","planAccess","concat","err","console","className","onClick","window","location","href"],"sources":["/Users/siteoptz/siteoptz-scraping/src/components/DashboardAuth.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useUser } from '../contexts/UserContext';\nimport CyfeService from '../services/CyfeService';\nimport './DashboardAuth.css';\n\nconst DashboardAuth = ({ children, dashboardId, requiredPlan }) => {\n  const { user, currentPlan } = useUser();\n  const [hasAccess, setHasAccess] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    checkDashboardAccess();\n  }, [dashboardId, currentPlan]);\n\n  const checkDashboardAccess = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Check if user has access to the dashboard\n      const access = CyfeService.hasDashboardAccess(user?.id, currentPlan, dashboardId);\n      \n      // Check if user's plan meets requirements\n      const planHierarchy = ['free', 'starter', 'pro', 'enterprise'];\n      const currentPlanIndex = planHierarchy.indexOf(currentPlan);\n      const requiredPlanIndex = planHierarchy.indexOf(requiredPlan);\n      \n      const planAccess = currentPlanIndex >= requiredPlanIndex;\n      \n      setHasAccess(access && planAccess);\n      \n      if (!access) {\n        setError('Dashboard not available for your current plan');\n      } else if (!planAccess) {\n        setError(`This dashboard requires ${requiredPlan} plan or higher`);\n      }\n    } catch (err) {\n      setError('Error checking dashboard access');\n      console.error('Dashboard access check failed:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"dashboard-auth-loading\">\n        <div className=\"loading-spinner\"></div>\n        <p>Checking dashboard access...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"dashboard-auth-error\">\n        <div className=\"error-icon\">‚ö†Ô∏è</div>\n        <h3>Access Restricted</h3>\n        <p>{error}</p>\n        <button \n          className=\"upgrade-button\"\n          onClick={() => window.location.href = `/dashboard/${currentPlan}#upgrade`}\n        >\n          Upgrade Plan\n        </button>\n      </div>\n    );\n  }\n\n  if (!hasAccess) {\n    return (\n      <div className=\"dashboard-auth-denied\">\n        <div className=\"denied-icon\">üîí</div>\n        <h3>Dashboard Not Available</h3>\n        <p>This dashboard is not included in your current plan.</p>\n        <button \n          className=\"upgrade-button\"\n          onClick={() => window.location.href = `/dashboard/${currentPlan}#upgrade`}\n        >\n          View Upgrade Options\n        </button>\n      </div>\n    );\n  }\n\n  return <>{children}</>;\n};\n\nexport default DashboardAuth;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}