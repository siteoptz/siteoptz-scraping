{"ast":null,"code":"import React,{createContext,useContext}from'react';import{loadStripe}from'@stripe/stripe-js';import{pricingPlans,stripeConfig}from'../pricing-plans';import{jsx as _jsx}from\"react/jsx-runtime\";const StripeContext=/*#__PURE__*/createContext();export const useStripe=()=>{const context=useContext(StripeContext);if(!context){throw new Error('useStripe must be used within a StripeProvider');}return context;};export const StripeProvider=_ref=>{let{children}=_ref;const stripePromise=loadStripe(stripeConfig.publishableKey);const createCheckoutSession=async(priceId,planName)=>{try{const stripe=await stripePromise;if(!stripe){throw new Error('Stripe failed to load');}// Create checkout session on your backend\nconst response=await fetch('/api/create-checkout-session',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({priceId,planName,successUrl:\"\".concat(window.location.origin,\"/dashboard/success\"),cancelUrl:\"\".concat(window.location.origin,\"/dashboard/\").concat(planName.toLowerCase())})});const session=await response.json();// Redirect to Stripe Checkout\nconst{error}=await stripe.redirectToCheckout({sessionId:session.id});if(error){console.error('Error redirecting to checkout:',error);throw error;}}catch(error){console.error('Error creating checkout session:',error);throw error;}};const openUpgradeModal=async targetPlan=>{try{const plan=pricingPlans[targetPlan];if(!plan||!plan.stripePriceId){// Handle enterprise custom pricing\nwindow.open('/contact-sales','_blank');return;}await createCheckoutSession(plan.stripePriceId,targetPlan);}catch(error){console.error('Error opening upgrade modal:',error);// Fallback to contact sales\nwindow.open('/contact-sales','_blank');}};const value={stripePromise,createCheckoutSession,openUpgradeModal};return/*#__PURE__*/_jsx(StripeContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","loadStripe","pricingPlans","stripeConfig","jsx","_jsx","StripeContext","useStripe","context","Error","StripeProvider","_ref","children","stripePromise","publishableKey","createCheckoutSession","priceId","planName","stripe","response","fetch","method","headers","body","JSON","stringify","successUrl","concat","window","location","origin","cancelUrl","toLowerCase","session","json","error","redirectToCheckout","sessionId","id","console","openUpgradeModal","targetPlan","plan","stripePriceId","open","value","Provider"],"sources":["/Users/siteoptz/siteoptz-scraping/src/contexts/StripeContext.js"],"sourcesContent":["import React, { createContext, useContext } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { pricingPlans, stripeConfig } from '../pricing-plans';\n\nconst StripeContext = createContext();\n\nexport const useStripe = () => {\n  const context = useContext(StripeContext);\n  if (!context) {\n    throw new Error('useStripe must be used within a StripeProvider');\n  }\n  return context;\n};\n\nexport const StripeProvider = ({ children }) => {\n  const stripePromise = loadStripe(stripeConfig.publishableKey);\n\n  const createCheckoutSession = async (priceId, planName) => {\n    try {\n      const stripe = await stripePromise;\n      \n      if (!stripe) {\n        throw new Error('Stripe failed to load');\n      }\n\n      // Create checkout session on your backend\n      const response = await fetch('/api/create-checkout-session', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          priceId,\n          planName,\n          successUrl: `${window.location.origin}/dashboard/success`,\n          cancelUrl: `${window.location.origin}/dashboard/${planName.toLowerCase()}`\n        }),\n      });\n\n      const session = await response.json();\n\n      // Redirect to Stripe Checkout\n      const { error } = await stripe.redirectToCheckout({\n        sessionId: session.id,\n      });\n\n      if (error) {\n        console.error('Error redirecting to checkout:', error);\n        throw error;\n      }\n    } catch (error) {\n      console.error('Error creating checkout session:', error);\n      throw error;\n    }\n  };\n\n  const openUpgradeModal = async (targetPlan) => {\n    try {\n      const plan = pricingPlans[targetPlan];\n      \n      if (!plan || !plan.stripePriceId) {\n        // Handle enterprise custom pricing\n        window.open('/contact-sales', '_blank');\n        return;\n      }\n\n      await createCheckoutSession(plan.stripePriceId, targetPlan);\n    } catch (error) {\n      console.error('Error opening upgrade modal:', error);\n      // Fallback to contact sales\n      window.open('/contact-sales', '_blank');\n    }\n  };\n\n  const value = {\n    stripePromise,\n    createCheckoutSession,\n    openUpgradeModal\n  };\n\n  return (\n    <StripeContext.Provider value={value}>\n      {children}\n    </StripeContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}